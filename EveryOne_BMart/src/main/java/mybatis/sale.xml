<?xml version="1.0" encoding="UTF-8"?>


<!DOCTYPE mapper
	PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
	"https://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="sale">


	<select id="getAriaChart" resultType="sale.model.OrderInfoBean">
	   	SELECT
		 TO_CHAR(orderdate, 'YYYY-MM') AS orderdate,
		 SUM(o.pamount * p.price) AS totalPrice
		FROM
		 orderInfo o
		INNER JOIN
		 product p
		ON
		 o.pnum = p.pnum
		GROUP BY
		 TO_CHAR(orderdate, 'YYYY-MM')
		ORDER BY
		 orderdate
	</select>

<select id="getAdminMonthSumCount" resultType="HashMap">
   SELECT
    SUM(DECODE(TO_CHAR(orderdate, 'MM'), '01', pamount, 0)) AS "m1",
    SUM(DECODE(TO_CHAR(orderdate, 'MM'), '02', pamount, 0)) AS "m2",
    SUM(DECODE(TO_CHAR(orderdate, 'MM'), '03', pamount, 0)) AS "m3",
    SUM(DECODE(TO_CHAR(orderdate, 'MM'), '04', pamount, 0)) AS "m4",
    SUM(DECODE(TO_CHAR(orderdate, 'MM'), '05', pamount, 0)) AS "m5",
    SUM(DECODE(TO_CHAR(orderdate, 'MM'), '06', pamount, 0)) AS "m6",
    SUM(DECODE(TO_CHAR(orderdate, 'MM'), '07', pamount, 0)) AS "m7",
    SUM(DECODE(TO_CHAR(orderdate, 'MM'), '08', pamount, 0)) AS "m8",
    SUM(DECODE(TO_CHAR(orderdate, 'MM'), '09', pamount, 0)) AS "m9",
    SUM(DECODE(TO_CHAR(orderdate, 'MM'), '10', pamount, 0)) AS "m10",
    SUM(DECODE(TO_CHAR(orderdate, 'MM'), '11', pamount, 0)) AS "m11",
    SUM(DECODE(TO_CHAR(orderdate, 'MM'), '12', pamount, 0)) AS "m12"
FROM
    orderInfo
</select>

<select id="getAdminMonthSumCount2" resultType="HashMap">
	SELECT
	    SUM(DECODE(TO_CHAR(orderdate, 'MM'), '01', o.pamount * p.price, 0)) AS "m1",
	    SUM(DECODE(TO_CHAR(orderdate, 'MM'), '02', o.pamount * p.price, 0)) AS "m2",
	    SUM(DECODE(TO_CHAR(orderdate, 'MM'), '03', o.pamount * p.price, 0)) AS "m3",
	    SUM(DECODE(TO_CHAR(orderdate, 'MM'), '04', o.pamount * p.price, 0)) AS "m4",
	    SUM(DECODE(TO_CHAR(orderdate, 'MM'), '05', o.pamount * p.price, 0)) AS "m5",
	    SUM(DECODE(TO_CHAR(orderdate, 'MM'), '06', o.pamount * p.price, 0)) AS "m6",
	    SUM(DECODE(TO_CHAR(orderdate, 'MM'), '07', o.pamount * p.price, 0)) AS "m7",
	    SUM(DECODE(TO_CHAR(orderdate, 'MM'), '08', o.pamount * p.price, 0)) AS "m8",
	    SUM(DECODE(TO_CHAR(orderdate, 'MM'), '09', o.pamount * p.price, 0)) AS "m9",
	    SUM(DECODE(TO_CHAR(orderdate, 'MM'), '10', o.pamount * p.price, 0)) AS "m10",
	    SUM(DECODE(TO_CHAR(orderdate, 'MM'), '11', o.pamount * p.price, 0)) AS "m11",
	    SUM(DECODE(TO_CHAR(orderdate, 'MM'), '12', o.pamount * p.price, 0)) AS "m12"
	FROM
	    orderInfo o
	JOIN product p ON o.pnum = p.pnum
	GROUP BY
	    TO_CHAR(orderdate, 'YYYY')
	ORDER BY
        TO_CHAR(orderdate, 'YYYY')
</select> 

</mapper>          
     